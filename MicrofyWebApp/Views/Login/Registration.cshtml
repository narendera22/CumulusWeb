@{
    Layout = "";
    ViewData["Title"] = "SignUp";

}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>@ViewData["Title"] - Welcome to Cumulus</title>
    <link rel="stylesheet" href="~/lib/jquery/dist/css/jquery-confirm.css" />

    <link href="//netdna.bootstrapcdn.com/bootstrap/3.0.0/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="https://pro.fontawesome.com/releases/v5.10.0/css/all.css" integrity="sha384-AYmEC3Yw5cVb3ZcuHtOA93w35dYTsvhLPVnYs9eStHfGJvOvKxVfELGroGkvsg+p" crossorigin="anonymous" />
    <link rel="stylesheet" href="~/lib/bootstrap/dist/css/bootstrap.css" />
    <link rel="stylesheet" href="~/css/site.css" />
    <style type="text/css">
        .input-group-addon {
            padding: 6px 20px !important;
        }
        /*.jconfirm .jconfirm-holder {*/
        /*max-height: 100%;*/
        /*padding-right: 250px !important;
        }*/
        .justify-content-lg-center {
            justify-content: left !important;
        }
    </style>
</head>
<body>
    <div class="container" style="padding-left:60px">
        <form class="well form-horizontal" action=" " method="post" id="Registration_form">
            <fieldset>
                <div class="imglogo" style="display:flex;">
                    <img id="img_logo" alt="Logo" src="~/Image/Cumulus.png" onclick="@("window.location.href='" + @Url.Action("Login", "Login") + "'");" />
                    <div class=" col-lg-8" style="padding-top:40px">
                        <center><h2><b>Sign-up</b></h2></center>
                    </div>
                </div>
                <!-- Form Name -->
                <!-- Text input-->

                <div class="form-group">
                    <label class="col-md-4 control-label"><span style="color:red;">*</span>  Full Name</label>
                    <div class="col-md-4 inputGroupContainer">
                        <div class="input-group">
                            <span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span>
                            <input name="first_name" id="first_name" placeholder="User Name" class="form-control" type="text" required>
                            <span data-alertid="first_name"></span>
                        </div>
                    </div>
                </div>



                @*<div class="form-group">
                        <label class="col-md-4 control-label"><span style="color:red;">*</span>  Project Name</label>
                        <div class="col-md-4 inputGroupContainer">
                            <div class="input-group">
                                <span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span>
                                <input name="project_name" id="project_name" placeholder="Project Name" class="form-control" type="text" required>
                            </div>
                        </div>
                    </div>*@


                <!--<div class="form-group">
                <label class="col-md-4 control-label">Role</label>
                <div class="col-md-4 selectContainer">
                    <div class="input-group">
                        <span class="input-group-addon"><i class="glyphicon glyphicon-list"></i></span>
                        <select name="role" id="role" class="form-control selectpicker" required>
                            <option value="">Select Role</option>
                            <option value="Administrator">Administrator</option>
                            <option value="User">User</option>-->
                @*<option>Auditor</option>*@
                <!--</select>
                        </div>
                    </div>
                </div>-->
                <!-- Text input-->

                <div class="form-group">
                    <label class="col-md-4 control-label"><span style="color:red;">*</span>  Userid</label>
                    <div class="col-md-4 inputGroupContainer">
                        <div class="input-group">
                            <span class="input-group-addon"><i class="glyphicon glyphicon-envelope"></i></span>
                            <input name="userid" id="userid" placeholder="Userid" class="form-control" type="email" required>
                        </div>
                    </div>
                </div>

                <!-- Text input-->

                <div class="form-group">
                    <label class="col-md-4 control-label"><span style="color:red;">*</span>  Password</label>
                    <div class="col-md-4 inputGroupContainer">
                        <div class="input-group">
                            <span class="input-group-addon"><i class="glyphicon glyphicon-lock"></i></span>
                            <input name="user_password" type="password" id="user_password" title="Password must contain: Minimum 8 characters atleast 1 Alphabet and 1 Number"
                                   class="form-control" placeholder="Enter Password" required />
                        </div>
                    </div>
                </div>

                <!-- Text input-->

                <div class="form-group">
                    <label class="col-md-4 control-label"><span style="color:red;">*</span>  Confirm Password</label>
                    <div class="col-md-4 inputGroupContainer">
                        <div class="input-group">
                            <span class="input-group-addon"><i class="glyphicon glyphicon-lock"></i></span>
                            <input name="confirm_password" id="confirm_password" placeholder="Confirm Password" class="form-control" required type="password">
                        </div>
                    </div>
                </div>


                <div class="form-group">
                    <label class="col-md-4 control-label"><span style="color:red;">*</span>  Project & Customer Name</label>
                    <div class="col-md-8 inputGroupContainer">
                        <div class="input-group">
                            @*<span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span>
                                <input name="cust_name" id="cust_name" placeholder="Customer Name" class="form-control" type="text" required>*@
                            <div id="dynamic-PrjCus-field-1" class=" col-md-12 form-group dynamic-field" style="display:flex;" data-tags="add">
                                <span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span>
                                <input name="project_name" id="project_name-1" placeholder="Project Name" class="col-md-3 form-control" type="text" onkeydown="addprj($(this))" required>

                                <span class="input-group-addon"><i class="glyphicon glyphicon-user"></i></span>
                                <input name="cust_name" id="cust_name-1" placeholder="Customer Name" class="col-md-3 form-control" type="text" required>
                                <a href="#" class="add" title="Add Tags" style="padding:5px; display:block;" onclick="Viewprj(); return false;">
                                    <i class="fas fa-plus"></i>
                                </a>
                                <a href="#" class="delete" title="delete Tags" style="padding:5px; display:none;" onclick="deleteprj($(this)); return false;">
                                    <i class="fas fa-trash-alt"></i>
                                </a>
                            </div>
                        </div>
                    </div>
                </div>



                <!-- Select Basic -->
                <!-- Success message -->
                @*<div class="alert alert-success" role="alert" id="success_message">Success <i class="glyphicon glyphicon-thumbs-up"></i> Success!.</div>*@

                <!-- Button -->
                <div class="form-group">
                    <div class="col-md-4 control-label">
                        <button type="button" id="btnBack" onclick="@("window.location.href='" + @Url.Action("Login", "Login") + "'");" class="btn btn-warning"><span class="glyphicon glyphicon-arrow-left"></span> BACK</button>
                    </div>
                    <div class="col-md-4 control-label">
                        <button type="submit" class="btn btn-warning">SUBMIT <span class="glyphicon glyphicon-send"></span></button>
                    </div>
                </div>

            </fieldset>
        </form>
    </div>

    <script src="~/lib/jquery/dist/jquery.js"></script>
    <script src="~/lib/jquery/dist/jquery-confirm.js"></script>

    <script src="~/lib/bootstrap/dist/js/bootstrap.bundle.js"></script>

    <script src="~/js/site.js" asp-append-version="true"></script>

</body>
</html>
<script type="text/javascript">
    window.onload = function () {
        var txtPassword = document.getElementById("user_password");
        var txtConfirmPassword = document.getElementById("confirm_password");
        txtPassword.onchange = ConfirmPassword;
        txtConfirmPassword.onkeyup = ConfirmPassword;
        function ConfirmPassword() {
            txtConfirmPassword.setCustomValidity("");
            if (txtPassword.value != txtConfirmPassword.value) {
                txtConfirmPassword.setCustomValidity("Passwords do not match.");
            }
        }
    }

$('#Registration_form').submit(function () {
    var username = $('#first_name').val();
    //var custname = $('#cust_name').val();
    //var projectname = $('#project_name').val();
    var role = "User"; //$('#role :selected').text();
    var userid = $('#userid').val();
    var password = $('#user_password').val();
    var confrmpassword = $('#confirm_password').val();

    var $projCus = $('.dynamic-field');
    var prj = [];
    $projCus.each(function (key, value) {
        var Proj = $("#project_name-" + (key + 1)).val();
        var Cust = $("#cust_name-" + (key + 1)).val();
        if (Proj != "") {
            var obj = {};
            obj = {
                "ProjectName": Proj,
                "CustomerName": Cust
            };
            prj.push(obj);
        }
    });

    //var Projects = [{
    //    "ProjectName": projectname,
    //    "CustomerName": custname
    //}];

    var UserDetails = {
        "username": userid,
        "password": password,
        "fullName": username,
        "userRole": role,
        "isActive": false,
        "projects": prj
    }

        var redirecturl = "/Login/signup";
    $.post(redirecturl, UserDetails, function (data) {

        var title = "";
            var type = "";
            if (data.statusCode == true) {
                title = "Success!!";
                type = "green";
            }
            else {
                title = "Error!!";
                type = "red";
            }
            $.alert({
                    title: title,
                    content: data.responseMessage +" \n Please contact Admin to Unlock your account!!!",
                    type: type,
                    onAction: function () {
                        window.location.href = '@Url.Action("Login","Login")';
                    }
                });
        })
        .fail(function (response) {
           $.alert({
                title: 'Error!!',
                content: response,
                alignMiddle: true,
                type: 'red'
            });
        });
    return false;


});
</script>
@*<script type="text/javascript">
    var prjclassName = ".dynamic-field";
    var prjcount = 0;
    var prjfield = "";
    var prjmaxFields = 5;

    function addprj(e) {
        if (prjtotalFields() != prjmaxFields) {
            if (e.parent().data('tags') === 'hold') { return false; }
            else { e.parent().data('tags', 'hold'); }
            prjcount = prjtotalFields() + 1;
            prjfield = $("#dynamic-PrjCus-field-1").clone();
            prjfield.attr("id", "dynamic-PrjCus-field-" + prjcount);
            prjfield.find("#cust_name-1").attr("id", "cust_name-" + prjcount);
            prjfield.find("#project_name-1").attr("id", "project_name-" + prjcount);
            prjfield.find('#cust_name-' + prjcount).removeAttr('required')
            prjfield.find('#project_name-' + prjcount).removeAttr('required')
            prjfield.attr('data-tags', 'add');
            prjfield.find("input").val("");
            prjfield.find("a.delete").show();
            $(prjclassName + ":last").after($(prjfield));

        }
    }

    function prjtotalFields() {
        return $(prjclassName).length;
    }

    function deleteprj(e) {
        e.parent().remove();
        prjcount = prjtotalFields();
        if (prjcount <= 1) { $(".dynamic-field").data('tags', 'add'); }
        else {
            $(prjclassName + ":last").data('tags', 'add')
        }
        return false;
    }

    function Viewprj() {
        if (prjtotalFields() != prjmaxFields) {
            prjcount = prjtotalFields() + 1;
            prjfield = $("#dynamic-PrjCus-field-1").clone();
            prjfield.attr("id", "dynamic-PrjCus-field-" + prjcount);
            //field.find("#txtkey-1").attr("id", "txtkey-" + count);
            prjfield.find("#cust_name-1").attr("id", "cust_name-" + prjcount);
            prjfield.find("#project_name-1").attr("id", "project_name-" + prjcount);
            prjfield.attr('data-tags', 'add');
            prjfield.find("input").val("");
            prjfield.find("a.delete").show();
            $(prjclassName + ":last").after($(prjfield));

        }
    }
</script>*@